# GenIce3 API

結晶構造を JSON でリクエストし、酸素骨格＋水素結合を PDB 形式で返す FastAPI サーバー。

## 特徴

- **gromacs エクスポーターを使わない**: 水素配置（depol_loop）を必要としないため、イオン配置など不正な設定でも失敗しない
- **酸素のみ + CONECT**: 3Dmol.js などで水素結合ネットワークを表示可能
- **residue 番号 = 水分子インデックス + 1**: クリック選択時のマッピングに利用可能

## セットアップ

```bash
# プロジェクトルートで
pip install -e .
pip install -r api/requirements.txt
```

## 起動

```bash
# プロジェクトルートから
uvicorn api.server:app --reload --host 0.0.0.0 --port 8000
```

## エンドポイント

### POST /generate

**リクエスト例（最小）:**

```json
{
  "unitcell": "1h",
  "rep": [2, 2, 2]
}
```

**リクエスト例（オプション付き）:**

```json
{
  "unitcell": "A15",
  "rep": [2, 2, 2],
  "unitcell_options": {
    "shift": [0.1, 0.1, 0.1],
    "density": 0.8,
    "assess_cages": true
  },
  "seed": 42
}
```

より多くの例は `api/examples/` を参照。

**レスポンス例:**

```json
{
  "pdb": "REMARK   Generated by GenIce3 API...\nCRYST1...\nATOM  ...",
  "format": "pdb",
  "cell": [[...], [...], [...]],
  "water_count": 64,
  "cages": null
}
```

### GET /health

ヘルスチェック。`{"status": "ok"}` を返す。
